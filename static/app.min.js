document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("chat-container"),t=document.getElementById("user-input"),n=document.getElementById("send-button"),s=document.getElementById("typing-indicator"),a=(t,n)=>{const s=document.createElement("div");s.className="message "+(n?"user-message":"assistant-message");t.split("\n").filter((e=>e.trim())).forEach((e=>{const t=document.createElement("p");t.textContent=e,s.appendChild(t)})),e.appendChild(s),e.scrollTop=e.scrollHeight},o=e=>{n.disabled=e,t.disabled=e,s.classList.toggle("hidden",!e)},c=async()=>{const n=t.value.trim();if(n){a(n,!0),t.value="",o(!0);try{const t=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n})}),s=await t.json();if(s.answer&&(a(s.answer,!1),s.sources&&s.sources.length>0)){const t=document.createElement("div");t.className="source-citation",t.textContent=`Sources: ${s.sources.join(", ")}`,e.lastElementChild.appendChild(t)}}catch(e){a("Error: Unable to get response",!1),console.error("Error:",e)}finally{o(!1)}}};n.addEventListener("click",c),t.addEventListener("keypress",(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),c())}))}));