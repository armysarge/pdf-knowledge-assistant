document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("chat-form"),t=document.getElementById("user-input"),n=document.getElementById("chat-messages");function s(e,t){const n=document.createElement("div");return n.className="message "+(t?"user-message":"assistant-message"),n.textContent=e,n}e.addEventListener("submit",(async e=>{e.preventDefault();const r=t.value.trim();if(!r)return;n.appendChild(s(r,!0)),t.value="",n.scrollTop=n.scrollHeight;const o=function(){const e=document.createElement("div");return e.className="typing-indicator assistant-message",e.innerHTML='\n            <div class="typing-dot"></div>\n            <div class="typing-dot"></div>\n            <div class="typing-dot"></div>\n        ',e}();n.appendChild(o),n.scrollTop=n.scrollHeight;try{const e=await fetch("/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:r})}),t=await e.json();if(o.remove(),n.appendChild(s(t.answer,!1)),t.sources&&t.sources.length>0){const e=document.createElement("div");e.className="text-xs text-gray-500 mt-2 ml-4",e.innerHTML="<strong>Sources:</strong><br>"+t.sources.map((e=>`- ${e}`)).join("<br>"),n.appendChild(e)}}catch(e){o.remove(),n.appendChild(s("Sorry, there was an error processing your request.",!1))}n.scrollTop=n.scrollHeight})),t.addEventListener("keydown",(t=>{"Enter"===t.key&&t.ctrlKey&&e.dispatchEvent(new Event("submit"))}))}));